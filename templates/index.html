<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebCrawler - Modern Website Crawling API</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6366f1;
            --primary-dark: #4f46e5;
            --secondary-color: #8b5cf6;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --background: #f8fafc;
            --surface: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header-left h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        .header-left p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .ws-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
        }

        .ws-indicator.connected {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .ws-indicator.disconnected {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .ws-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .ws-dot.connected {
            background: #10b981;
        }

        .ws-dot.disconnected {
            background: #ef4444;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        /* Cards */
        .card {
            background: var(--surface);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }

        .card-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
        }

        .icon-primary { background: var(--primary-color); }
        .icon-success { background: var(--success-color); }
        .icon-warning { background: var(--warning-color); }

        /* Tabs */
        .tabs {
            display: flex;
            background: var(--background);
            border-radius: 12px;
            padding: 0.25rem;
            margin-bottom: 2rem;
        }

        .tab {
            flex: 1;
            padding: 0.75rem 1.5rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .tab.active {
            background: var(--surface);
            color: var(--primary-color);
            box-shadow: var(--shadow);
        }

        .tab:hover:not(.active) {
            color: var(--text-primary);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--surface);
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            margin-right: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--text-secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: #475569;
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Progress Bar */
        .progress-container {
            margin: 1rem 0;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Results */
        .result {
            background: var(--background);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px solid var(--border);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .result-success { color: var(--success-color); }
        .result-error { color: var(--error-color); }

        .result-content {
            background: var(--surface);
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid var(--border);
        }

        .result pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.9rem;
            max-height: 400px;
            overflow-y: auto;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--primary-color);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Live Updates */
        .live-updates {
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            height: 500px;
            overflow-y: auto;
            border: 1px solid #334155;
        }

        .update-item {
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            border-radius: 8px;
            border-left: 3px solid var(--primary-color);
            font-size: 0.9rem;
        }

        .update-success {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: var(--success-color);
        }

        .update-error {
            background: rgba(239, 68, 68, 0.1);
            border-left-color: var(--error-color);
        }

        .update-progress {
            background: rgba(99, 102, 241, 0.1);
            border-left-color: var(--primary-color);
        }

        .update-time {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-bottom: 0.25rem;
        }

        .clear-btn {
            background: var(--error-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 1rem;
        }

        .clear-btn:hover {
            background: #dc2626;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stat-card {
            background: var(--background);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .card {
                padding: 1.5rem;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Export Section */
        .export-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
        }

        .export-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        /* API Documentation */
        .api-docs {
            background: var(--background);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .api-docs h3 {
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .api-endpoint {
            background: var(--surface);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.75rem;
            border: 1px solid var(--border);
        }

        .api-method {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .method-post { background: #10b981; color: white; }
        .method-get { background: #3b82f6; color: white; }

        .api-url {
            font-family: 'Monaco', 'Consolas', monospace;
            color: var(--text-primary);
        }

        /* New styles for Advanced Tab */
        .options-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }

        .options-section h3 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            color: var(--text-primary);
            cursor: pointer;
        }

        .checkmark {
            width: 18px;
            height: 18px;
            border: 2px solid var(--border);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--surface);
        }

        .checkbox-label input[type="checkbox"] {
            display: none; /* Hide default checkbox */
        }

        .checkbox-label input[type="checkbox"]:checked + .checkmark {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .checkbox-label input[type="checkbox"]:checked + .checkmark:after {
            content: "\f00c"; /* Checkmark icon */
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            color: white;
            font-size: 12px;
        }

        /* New styles for Scheduled Jobs Tab */
        .jobs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .job-card {
            background: var(--surface);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .job-header h4 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .job-status {
            padding: 0.4rem 0.8rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 600;
            color: white;
        }

        .status-active { background: var(--success-color); }
        .status-paused { background: var(--warning-color); }
        .status-running { background: var(--primary-color); }
        .status-error { background: var(--error-color); }
        .status-complete { background: var(--success-color); }
        .status-unknown { background: var(--text-secondary); }

        .job-details p {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .job-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="header-content">
                <div class="header-left">
                    <h1><i class="fas fa-spider"></i> WebCrawler</h1>
                    <p>Modern website crawling with real-time updates</p>
                </div>
                <div class="header-right">
                    <div id="wsStatus" class="ws-indicator disconnected">
                        <div class="ws-dot disconnected"></div>
                        <span>WebSocket: Disconnected</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="main-layout">
            <div class="main-content">
                <div class="card">
                    <div class="tabs">
                        <div class="tab active" onclick="switchTab('single')">
                            <i class="fas fa-link"></i> Single URL
                        </div>
                        <div class="tab" onclick="switchTab('batch')">
                            <i class="fas fa-list"></i> Multiple URLs
                        </div>
                        <div class="tab" onclick="switchTab('advanced')">
                            <i class="fas fa-cogs"></i> Advanced
                        </div>
                        <div class="tab" onclick="switchTab('scheduled')">
                            <i class="fas fa-clock"></i> Scheduled Jobs
                        </div>
                        <div class="tab" onclick="switchTab('stats')">
                            <i class="fas fa-chart-bar"></i> Statistics
                        </div>
                    </div>

                    <!-- Single URL Tab -->
                    <div id="single" class="tab-content active">
                        <div class="card-header">
                            <div class="card-icon icon-primary">
                                <i class="fas fa-globe"></i>
                            </div>
                            <h2>Single Website Crawling</h2>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="singleUrl">
                                <i class="fas fa-link"></i> Website URL
                            </label>
                            <input type="url" id="singleUrl" class="form-input" 
                                   placeholder="https://example.com" required>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="scrapeSingle()">
                                <i class="fas fa-play"></i> Start Crawling
                            </button>
                            <button class="btn btn-secondary" onclick="exportSingleCSV()">
                                <i class="fas fa-file-csv"></i> Export CSV
                            </button>
                            <button class="btn btn-secondary" onclick="exportSingleJSON()">
                                <i class="fas fa-file-code"></i> Export JSON
                            </button>
                        </div>
                        
                        <div id="singleResult"></div>
                    </div>

                    <!-- Multiple URLs Tab -->
                    <div id="batch" class="tab-content">
                        <div class="card-header">
                            <div class="card-icon icon-warning">
                                <i class="fas fa-layer-group"></i>
                            </div>
                            <h2>Batch Crawling</h2>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="batchUrls">
                                <i class="fas fa-list"></i> Website URLs (one per line)
                            </label>
                            <textarea id="batchUrls" class="form-textarea" 
                                      placeholder="https://example1.com&#10;https://example2.com&#10;https://example3.com"></textarea>
                        </div>
                        
                        <button class="btn btn-primary" onclick="scrapeBatch()">
                            <i class="fas fa-play"></i> Start Batch Crawling
                        </button>
                        
                        <div class="progress-container" id="batchProgress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                            </div>
                            <div class="progress-text" id="progressText">0% Complete</div>
                        </div>
                        
                        <div id="batchResult"></div>
                    </div>

                    <!-- Advanced Tab -->
                    <div id="advanced" class="tab-content">
                        <div class="card-header">
                            <div class="card-icon icon-success">
                                <i class="fas fa-cogs"></i>
                            </div>
                            <h2>Advanced Crawling</h2>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="advancedUrl">
                                <i class="fas fa-link"></i> Website URL
                            </label>
                            <input type="url" id="advancedUrl" class="form-input" 
                                   placeholder="https://example.com" required>
                        </div>

                        <!-- Basic Options -->
                        <div class="options-section">
                            <h3><i class="fas fa-sliders-h"></i> Basic Options</h3>
                            <div class="options-grid">
                                <div class="form-group">
                                    <label class="form-label" for="maxDepth">Max Depth</label>
                                    <input type="number" id="maxDepth" class="form-input" value="1" min="1" max="10">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="maxPages">Max Pages</label>
                                    <input type="number" id="maxPages" class="form-input" value="1" min="1" max="100">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="timeout">Timeout (seconds)</label>
                                    <input type="number" id="timeout" class="form-input" value="30" min="5" max="300">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="delay">Delay (ms)</label>
                                    <input type="number" id="delay" class="form-input" value="0" min="0" max="10000">
                                </div>
                            </div>
                        </div>

                        <!-- Extraction Options -->
                        <div class="options-section">
                            <h3><i class="fas fa-download"></i> Extraction Options</h3>
                            <div class="options-grid">
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="extractImages" checked>
                                        <span class="checkmark"></span>
                                        Extract Images
                                    </label>
                                </div>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="extractLinks" checked>
                                        <span class="checkmark"></span>
                                        Extract Links
                                    </label>
                                </div>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="extractForms">
                                        <span class="checkmark"></span>
                                        Extract Forms
                                    </label>
                                </div>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="extractTables">
                                        <span class="checkmark"></span>
                                        Extract Tables
                                    </label>
                                </div>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="extractScripts">
                                        <span class="checkmark"></span>
                                        Extract Scripts
                                    </label>
                                </div>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="extractStyles">
                                        <span class="checkmark"></span>
                                        Extract Styles
                                    </label>
                                </div>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="extractHeaders">
                                        <span class="checkmark"></span>
                                        Extract Headers (H1, H2, H3)
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Filtering Options -->
                        <div class="options-section">
                            <h3><i class="fas fa-filter"></i> Filtering Options</h3>
                            <div class="form-group">
                                <label class="form-label" for="includePatterns">
                                    Include Patterns (regex, one per line)
                                </label>
                                <textarea id="includePatterns" class="form-textarea" 
                                          placeholder=".*\.html&#10;.*product.*"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="excludePatterns">
                                    Exclude Patterns (regex, one per line)
                                </label>
                                <textarea id="excludePatterns" class="form-textarea" 
                                          placeholder=".*\.pdf&#10;.*admin.*"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="allowedDomains">
                                    Allowed Domains (one per line)
                                </label>
                                <textarea id="allowedDomains" class="form-textarea" 
                                          placeholder="example.com&#10;subdomain.example.com"></textarea>
                            </div>
                        </div>

                        <!-- Custom Selectors -->
                        <div class="options-section">
                            <h3><i class="fas fa-code"></i> Custom Selectors</h3>
                            <div class="form-group">
                                <label class="form-label" for="customSelectors">
                                    Custom CSS Selectors (JSON format)
                                </label>
                                <textarea id="customSelectors" class="form-textarea" 
                                          placeholder='{"price": ".price", "rating": ".rating", "author": ".author"}'></textarea>
                            </div>
                        </div>

                        <!-- User Agent & Headers -->
                        <div class="options-section">
                            <h3><i class="fas fa-user"></i> User Agent & Headers</h3>
                            <div class="form-group">
                                <label class="form-label" for="userAgent">User Agent</label>
                                <input type="text" id="userAgent" class="form-input" 
                                       value="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="customHeaders">
                                    Custom Headers (JSON format)
                                </label>
                                <textarea id="customHeaders" class="form-textarea" 
                                          placeholder='{"Accept-Language": "en-US,en;q=0.9", "Accept": "text/html,application/xhtml+xml"}'></textarea>
                            </div>
                        </div>

                        <!-- Advanced Settings -->
                        <div class="options-section">
                            <h3><i class="fas fa-advanced"></i> Advanced Settings</h3>
                            <div class="options-grid">
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="followRedirects" checked>
                                        <span class="checkmark"></span>
                                        Follow Redirects
                                    </label>
                                </div>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="respectRobotsTxt">
                                        <span class="checkmark"></span>
                                        Respect robots.txt
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="scrapeAdvanced()">
                                <i class="fas fa-play"></i> Start Advanced Crawling
                            </button>
                            <button class="btn btn-secondary" onclick="exportAdvancedCSV()">
                                <i class="fas fa-file-csv"></i> Export Advanced CSV
                            </button>
                            <button class="btn btn-secondary" onclick="exportAdvancedJSON()">
                                <i class="fas fa-file-code"></i> Export Advanced JSON
                            </button>
                        </div>
                        
                        <div id="advancedResult"></div>
                    </div>

                    <!-- Scheduled Jobs Tab -->
                    <div id="scheduled" class="tab-content">
                        <div class="card-header">
                            <div class="card-icon icon-warning">
                                <i class="fas fa-clock"></i>
                            </div>
                            <h2>Scheduled Jobs</h2>
                        </div>
                        
                        <!-- Job Creation Form -->
                        <div class="options-section">
                            <h3><i class="fas fa-plus"></i> Create New Job</h3>
                            <div class="form-group">
                                <label class="form-label" for="jobName">Job Name</label>
                                <input type="text" id="jobName" class="form-input" placeholder="Daily Website Check">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="jobDescription">Description</label>
                                <textarea id="jobDescription" class="form-textarea" placeholder="Optional description of the job"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="jobSchedule">Cron Schedule</label>
                                <input type="text" id="jobSchedule" class="form-input" placeholder="0 0 * * *" value="0 0 * * *">
                                <small style="color: var(--text-secondary); margin-top: 0.25rem; display: block;">
                                    Format: minute hour day month weekday (e.g., "0 0 * * *" = daily at midnight)
                                </small>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="jobUrl">Website URL</label>
                                <input type="url" id="jobUrl" class="form-input" placeholder="https://example.com">
                            </div>
                            
                            <button class="btn btn-primary" onclick="createScheduledJob()">
                                <i class="fas fa-plus"></i> Create Job
                            </button>
                        </div>

                        <!-- Job Management -->
                        <div class="options-section">
                            <h3><i class="fas fa-list"></i> Job Management</h3>
                            <div class="btn-group">
                                <button class="btn btn-secondary" onclick="loadScheduledJobs()">
                                    <i class="fas fa-refresh"></i> Refresh Jobs
                                </button>
                                <button class="btn btn-secondary" onclick="exportScheduledJobs()">
                                    <i class="fas fa-download"></i> Export Jobs
                                </button>
                                <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">
                                    <i class="fas fa-upload"></i> Import Jobs
                                </button>
                                <input type="file" id="importFile" style="display: none;" accept=".json" onchange="importScheduledJobs(this)">
                            </div>
                            
                            <div id="scheduledJobsList"></div>
                        </div>

                        <!-- Job Statistics -->
                        <div class="options-section">
                            <h3><i class="fas fa-chart-pie"></i> Job Statistics</h3>
                            <div id="schedulerStats"></div>
                        </div>
                        
                        <div id="scheduledResult"></div>
                    </div>

                    <!-- Statistics Tab -->
                    <div id="stats" class="tab-content">
                        <div class="card-header">
                            <div class="card-icon icon-success">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h2>Website Statistics</h2>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="statsUrl">
                                <i class="fas fa-link"></i> Website URL
                            </label>
                            <input type="url" id="statsUrl" class="form-input" 
                                   placeholder="https://example.com" required>
                        </div>
                        
                        <button class="btn btn-primary" onclick="getStats()">
                            <i class="fas fa-chart-bar"></i> Get Statistics
                        </button>
                        
                        <div id="statsResult"></div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-primary">
                            <i class="fas fa-code"></i>
                        </div>
                        <h2>API Documentation</h2>
                    </div>
                    
                    <div class="api-docs">
                        <div class="api-endpoint">
                            <span class="api-method method-post">POST</span>
                            <span class="api-url">/api/v1/scrape</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Crawl single website
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-post">POST</span>
                            <span class="api-url">/api/v1/scrape/advanced</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Crawl single website with advanced options
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-post">POST</span>
                            <span class="api-url">/api/v1/scrape/batch</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Crawl multiple websites
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-post">POST</span>
                            <span class="api-url">/api/v1/scrape/batch/advanced</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Crawl multiple websites with advanced options
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-get">GET</span>
                            <span class="api-url">/api/v1/scrape/stats?url=</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Get website statistics
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-post">POST</span>
                            <span class="api-url">/api/v1/scrape/stats/advanced</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Get website statistics with advanced options
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-get">GET</span>
                            <span class="api-url">/api/v1/export/csv?url=</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Export data to CSV
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-post">POST</span>
                            <span class="api-url">/api/v1/export/csv/advanced</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Export data to CSV with advanced options
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-get">GET</span>
                            <span class="api-url">/api/v1/export/json?url=</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Export data to JSON
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-post">POST</span>
                            <span class="api-url">/api/v1/export/json/advanced</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                Export data to JSON with advanced options
                            </div>
                        </div>
                        
                        <div class="api-endpoint">
                            <span class="api-method method-get">GET</span>
                            <span class="api-url">/api/v1/ws</span>
                            <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                                WebSocket for live updates
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-primary">
                            <i class="fas fa-broadcast-tower"></i>
                        </div>
                        <h2>Live Updates</h2>
                    </div>
                    
                    <div class="live-updates" id="liveUpdates">
                        <div class="update-item">
                            <div class="update-time">Connecting to WebSocket...</div>
                        </div>
                    </div>
                    
                    <button class="clear-btn" onclick="clearUpdates()">
                        <i class="fas fa-trash"></i> Clear Updates
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let ws = null;
        let isConnected = false;

        // WebSocket connection
        function connectWebSocket() {
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsUrl = `${protocol}//${window.location.host}/api/v1/ws`;
            
            ws = new WebSocket(wsUrl);
            
            ws.onopen = function() {
                isConnected = true;
                updateWSStatus(true);
                addUpdate('WebSocket connected successfully', 'success');
            };
            
            ws.onmessage = function(event) {
                const message = JSON.parse(event.data);
                handleWebSocketMessage(message);
            };
            
            ws.onclose = function() {
                isConnected = false;
                updateWSStatus(false);
                addUpdate('WebSocket disconnected', 'error');
                // Try to reconnect after 5 seconds
                setTimeout(connectWebSocket, 5000);
            };
            
            ws.onerror = function(error) {
                console.error('WebSocket error:', error);
                addUpdate('WebSocket error occurred', 'error');
            };
        }

        function updateWSStatus(connected) {
            const status = document.getElementById('wsStatus');
            const dot = status.querySelector('.ws-dot');
            
            if (connected) {
                status.textContent = 'WebSocket: Connected';
                status.className = 'ws-indicator connected';
                dot.className = 'ws-dot connected';
            } else {
                status.textContent = 'WebSocket: Disconnected';
                status.className = 'ws-indicator disconnected';
                dot.className = 'ws-dot disconnected';
            }
        }

        function handleWebSocketMessage(message) {
            switch(message.type) {
                case 'connected':
                    addUpdate(message.data.message, 'success');
                    break;
                case 'scraping_update':
                    const data = message.data;
                    if (data.status === 'started') {
                        addUpdate(`Started scraping: ${data.url}`, 'progress');
                    } else if (data.status === 'completed') {
                        addUpdate(`Completed scraping: ${data.url}`, 'success');
                    }
                    break;
                case 'batch_progress':
                    const progressData = message.data;
                    updateBatchProgress(progressData.progress, progressData.completed, progressData.total, progressData.current);
                    addUpdate(`Batch progress: ${progressData.completed}/${progressData.total} - ${progressData.current}`, 'progress');
                    break;
                case 'error':
                    const errorData = message.data;
                    addUpdate(`Error scraping ${errorData.url}: ${errorData.error}`, 'error');
                    break;
                case 'scheduled_job_start':
                    const startData = message.data;
                    addUpdate(`Scheduled job started: ${startData.job_name} (${startData.job_id})`, 'progress');
                    loadScheduledJobs(); // Refresh job list
                    break;
                case 'scheduled_job_complete':
                    const completeData = message.data;
                    addUpdate(`Scheduled job completed: ${completeData.job_name} - Duration: ${completeData.duration}`, 'success');
                    loadScheduledJobs(); // Refresh job list
                    loadSchedulerStats(); // Refresh stats
                    break;
                case 'scheduled_job_error':
                    const errorJobData = message.data;
                    addUpdate(`Scheduled job failed: ${errorJobData.job_name} - Error: ${errorJobData.error}`, 'error');
                    loadScheduledJobs(); // Refresh job list
                    loadSchedulerStats(); // Refresh stats
                    break;
                case 'scheduled_jobs_list':
                    // Job list updated via WebSocket
                    break;
                case 'scheduled_jobs_stats':
                    // Stats updated via WebSocket
                    break;
                case 'echo':
                    console.log('Echo message:', message);
                    break;
            }
        }

        function addUpdate(message, type) {
            const updatesContainer = document.getElementById('liveUpdates');
            const updateItem = document.createElement('div');
            updateItem.className = `update-item update-${type}`;
            updateItem.innerHTML = `
                <div class="update-time">${new Date().toLocaleTimeString()}</div>
                <div>${message}</div>
            `;
            updatesContainer.appendChild(updateItem);
            updatesContainer.scrollTop = updatesContainer.scrollHeight;
        }

        function clearUpdates() {
            document.getElementById('liveUpdates').innerHTML = '<div class="update-item"><div class="update-time">Updates cleared...</div></div>';
        }

        function updateBatchProgress(progress, completed, total, current) {
            const progressContainer = document.getElementById('batchProgress');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            progressContainer.style.display = 'block';
            progressFill.style.width = `${progress}%`;
            progressText.textContent = `${completed}/${total} (${progress.toFixed(1)}%) - ${current}`;
            
            if (completed >= total) {
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                }, 3000);
            }
        }

        function switchTab(tabName) {
            // Hide tabs
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show active tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function showLoading(elementId) {
            document.getElementById(elementId).innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading data...</p>
                </div>
            `;
        }

        function showError(elementId, message) {
            document.getElementById(elementId).innerHTML = `
                <div class="result">
                    <div class="result-header result-error">
                        <i class="fas fa-exclamation-triangle"></i>
                        Error
                    </div>
                    <div class="result-content">
                        <p>${message}</p>
                    </div>
                </div>
            `;
        }

        function showSuccess(elementId, data) {
            document.getElementById(elementId).innerHTML = `
                <div class="result">
                    <div class="result-header result-success">
                        <i class="fas fa-check-circle"></i>
                        Success
                    </div>
                    <div class="result-content">
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </div>
                </div>
            `;
        }

        async function scrapeSingle() {
            const url = document.getElementById('singleUrl').value;
            if (!url) {
                showError('singleResult', 'Please enter a URL.');
                return;
            }

            showLoading('singleResult');

            try {
                const response = await fetch('/api/v1/scrape', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ url: url })
                });

                const data = await response.json();

                if (response.ok) {
                    showSuccess('singleResult', data);
                } else {
                    showError('singleResult', data.error || 'Unknown error');
                }
            } catch (error) {
                showError('singleResult', 'Network error: ' + error.message);
            }
        }

        async function scrapeBatch() {
            const urlsText = document.getElementById('batchUrls').value;
            if (!urlsText) {
                showError('batchResult', 'Please enter URLs.');
                return;
            }

            const urls = urlsText.split('\n').filter(url => url.trim() !== '');
            if (urls.length === 0) {
                showError('batchResult', 'No valid URLs found.');
                return;
            }

            showLoading('batchResult');

            try {
                const response = await fetch('/api/v1/scrape/batch', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ urls: urls })
                });

                const data = await response.json();

                if (response.ok) {
                    showSuccess('batchResult', data);
                } else {
                    showError('batchResult', data.error || 'Unknown error');
                }
            } catch (error) {
                showError('batchResult', 'Network error: ' + error.message);
            }
        }

        async function getStats() {
            const url = document.getElementById('statsUrl').value;
            if (!url) {
                showError('statsResult', 'Please enter a URL.');
                return;
            }

            showLoading('statsResult');

            try {
                const response = await fetch(`/api/v1/scrape/stats?url=${encodeURIComponent(url)}`);
                const data = await response.json();

                if (response.ok) {
                    const stats = data.data;
                    document.getElementById('statsResult').innerHTML = `
                        <div class="result">
                            <div class="result-header result-success">
                                <i class="fas fa-chart-bar"></i>
                                Website Statistics
                            </div>
                            <div class="result-content">
                                <div class="stats-grid">
                                    <div class="stat-card">
                                        <div class="stat-number">${stats.title_length}</div>
                                        <div class="stat-label">Title Length</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">${stats.text_length}</div>
                                        <div class="stat-label">Text Length</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">${stats.image_count}</div>
                                        <div class="stat-label">Images</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">${stats.link_count}</div>
                                        <div class="stat-label">Links</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">${stats.keyword_count}</div>
                                        <div class="stat-label">Keywords</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">${stats.meta_count}</div>
                                        <div class="stat-label">Meta Tags</div>
                                    </div>
                                </div>
                                <pre style="margin-top: 1.5rem;">${JSON.stringify(stats, null, 2)}</pre>
                            </div>
                        </div>
                    `;
                } else {
                    showError('statsResult', data.error || 'Unknown error');
                }
            } catch (error) {
                showError('statsResult', 'Network error: ' + error.message);
            }
        }

        async function exportSingleCSV() {
            const url = document.getElementById('singleUrl').value;
            if (!url) {
                alert('Please enter a URL first.');
                return;
            }

            window.open(`/api/v1/export/csv?url=${encodeURIComponent(url)}`, '_blank');
        }

        async function exportSingleJSON() {
            const url = document.getElementById('singleUrl').value;
            if (!url) {
                alert('Please enter a URL first.');
                return;
            }

            window.open(`/api/v1/export/json?url=${encodeURIComponent(url)}`, '_blank');
        }

        // Advanced crawling functions
        function getAdvancedOptions() {
            // Parse arrays from textareas
            const includePatterns = document.getElementById('includePatterns').value
                .split('\n').filter(line => line.trim() !== '');
            const excludePatterns = document.getElementById('excludePatterns').value
                .split('\n').filter(line => line.trim() !== '');
            const allowedDomains = document.getElementById('allowedDomains').value
                .split('\n').filter(line => line.trim() !== '');

            // Parse custom selectors
            let customSelectors = {};
            try {
                const customSelectorsText = document.getElementById('customSelectors').value.trim();
                if (customSelectorsText) {
                    customSelectors = JSON.parse(customSelectorsText);
                }
            } catch (e) {
                console.error('Invalid custom selectors JSON:', e);
            }

            // Parse custom headers
            let headers = {};
            try {
                const headersText = document.getElementById('customHeaders').value.trim();
                if (headersText) {
                    headers = JSON.parse(headersText);
                }
            } catch (e) {
                console.error('Invalid custom headers JSON:', e);
            }

            return {
                max_depth: parseInt(document.getElementById('maxDepth').value) || 1,
                max_pages: parseInt(document.getElementById('maxPages').value) || 1,
                timeout: (parseInt(document.getElementById('timeout').value) || 30) * 1000000000, // Convert to nanoseconds
                delay: (parseInt(document.getElementById('delay').value) || 0) * 1000000, // Convert to nanoseconds
                include_patterns: includePatterns,
                exclude_patterns: excludePatterns,
                allowed_domains: allowedDomains,
                extract_images: document.getElementById('extractImages').checked,
                extract_links: document.getElementById('extractLinks').checked,
                extract_forms: document.getElementById('extractForms').checked,
                extract_tables: document.getElementById('extractTables').checked,
                extract_scripts: document.getElementById('extractScripts').checked,
                extract_styles: document.getElementById('extractStyles').checked,
                extract_headers: document.getElementById('extractHeaders').checked,
                custom_selectors: customSelectors,
                user_agent: document.getElementById('userAgent').value,
                headers: headers,
                follow_redirects: document.getElementById('followRedirects').checked,
                respect_robots_txt: document.getElementById('respectRobotsTxt').checked
            };
        }

        async function scrapeAdvanced() {
            const url = document.getElementById('advancedUrl').value;
            if (!url) {
                showError('advancedResult', 'Please enter a URL.');
                return;
            }

            const options = getAdvancedOptions();

            showLoading('advancedResult');

            try {
                const response = await fetch('/api/v1/scrape/advanced', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        url: url,
                        options: options
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    showSuccess('advancedResult', data);
                } else {
                    showError('advancedResult', data.error || 'Unknown error');
                }
            } catch (error) {
                showError('advancedResult', 'Network error: ' + error.message);
            }
        }

        async function exportAdvancedCSV() {
            const url = document.getElementById('advancedUrl').value;
            if (!url) {
                alert('Please enter a URL first.');
                return;
            }

            const options = getAdvancedOptions();

            try {
                const response = await fetch('/api/v1/export/csv/advanced', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        url: url,
                        options: options
                    })
                });

                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `advanced_scraped_data_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.csv`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                } else {
                    const data = await response.json();
                    alert('Export failed: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Export error: ' + error.message);
            }
        }

        async function exportAdvancedJSON() {
            const url = document.getElementById('advancedUrl').value;
            if (!url) {
                alert('Please enter a URL first.');
                return;
            }

            const options = getAdvancedOptions();

            try {
                const response = await fetch('/api/v1/export/json/advanced', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        url: url,
                        options: options
                    })
                });

                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `advanced_scraped_data_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.json`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                } else {
                    const data = await response.json();
                    alert('Export failed: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Export error: ' + error.message);
            }
        }

        // Initialize WebSocket connection when page loads
        document.addEventListener('DOMContentLoaded', function() {
            connectWebSocket();
            loadScheduledJobs();
            loadSchedulerStats();
        });

        // Scheduled Jobs functions
        async function createScheduledJob() {
            const name = document.getElementById('jobName').value;
            const description = document.getElementById('jobDescription').value;
            const schedule = document.getElementById('jobSchedule').value;
            const url = document.getElementById('jobUrl').value;

            if (!name || !schedule || !url) {
                alert('Please fill in all required fields (Name, Schedule, URL).');
                return;
            }

            try {
                const response = await fetch('/api/v1/scheduler/jobs', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        name: name,
                        description: description,
                        schedule: schedule,
                        url: url
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    alert('Job created successfully!');
                    // Clear form
                    document.getElementById('jobName').value = '';
                    document.getElementById('jobDescription').value = '';
                    document.getElementById('jobSchedule').value = '0 0 * * *';
                    document.getElementById('jobUrl').value = '';
                    // Reload jobs
                    loadScheduledJobs();
                } else {
                    alert('Failed to create job: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Error creating job: ' + error.message);
            }
        }

        async function loadScheduledJobs() {
            try {
                const response = await fetch('/api/v1/scheduler/jobs');
                const data = await response.json();

                if (response.ok) {
                    displayScheduledJobs(data.data);
                } else {
                    console.error('Failed to load jobs:', data.error);
                }
            } catch (error) {
                console.error('Error loading jobs:', error);
            }
        }

        function displayScheduledJobs(jobs) {
            const container = document.getElementById('scheduledJobsList');
            
            if (jobs.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No scheduled jobs found.</p>';
                return;
            }

            let html = '<div class="jobs-grid">';
            jobs.forEach(job => {
                const statusClass = getStatusClass(job.status);
                const nextRun = job.next_run ? new Date(job.next_run).toLocaleString() : 'N/A';
                const lastRun = job.last_run ? new Date(job.last_run).toLocaleString() : 'Never';

                html += `
                    <div class="job-card">
                        <div class="job-header">
                            <h4>${job.name}</h4>
                            <span class="job-status ${statusClass}">${job.status}</span>
                        </div>
                        <div class="job-details">
                            <p><strong>Description:</strong> ${job.description || 'No description'}</p>
                            <p><strong>URL:</strong> ${job.url}</p>
                            <p><strong>Schedule:</strong> ${job.schedule}</p>
                            <p><strong>Next Run:</strong> ${nextRun}</p>
                            <p><strong>Last Run:</strong> ${lastRun}</p>
                            <p><strong>Runs:</strong> ${job.run_count} | <strong>Errors:</strong> ${job.error_count}</p>
                        </div>
                        <div class="job-actions">
                            ${job.status === 'active' ? 
                                `<button class="btn btn-warning" onclick="pauseJob('${job.id}')">Pause</button>` :
                                `<button class="btn btn-success" onclick="resumeJob('${job.id}')">Resume</button>`
                            }
                            <button class="btn btn-primary" onclick="runJobNow('${job.id}')">Run Now</button>
                            <button class="btn btn-danger" onclick="deleteJob('${job.id}')">Delete</button>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            
            container.innerHTML = html;
        }

        function getStatusClass(status) {
            switch (status) {
                case 'active': return 'status-active';
                case 'paused': return 'status-paused';
                case 'running': return 'status-running';
                case 'error': return 'status-error';
                case 'complete': return 'status-complete';
                default: return 'status-unknown';
            }
        }

        async function pauseJob(jobId) {
            try {
                const response = await fetch(`/api/v1/scheduler/jobs/${jobId}/pause`, {
                    method: 'POST'
                });

                if (response.ok) {
                    loadScheduledJobs();
                } else {
                    const data = await response.json();
                    alert('Failed to pause job: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Error pausing job: ' + error.message);
            }
        }

        async function resumeJob(jobId) {
            try {
                const response = await fetch(`/api/v1/scheduler/jobs/${jobId}/resume`, {
                    method: 'POST'
                });

                if (response.ok) {
                    loadScheduledJobs();
                } else {
                    const data = await response.json();
                    alert('Failed to resume job: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Error resuming job: ' + error.message);
            }
        }

        async function runJobNow(jobId) {
            try {
                const response = await fetch(`/api/v1/scheduler/jobs/${jobId}/run`, {
                    method: 'POST'
                });

                if (response.ok) {
                    alert('Job started successfully!');
                } else {
                    const data = await response.json();
                    alert('Failed to run job: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Error running job: ' + error.message);
            }
        }

        async function deleteJob(jobId) {
            if (!confirm('Are you sure you want to delete this job?')) {
                return;
            }

            try {
                const response = await fetch(`/api/v1/scheduler/jobs/${jobId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    loadScheduledJobs();
                } else {
                    const data = await response.json();
                    alert('Failed to delete job: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Error deleting job: ' + error.message);
            }
        }

        async function loadSchedulerStats() {
            try {
                const response = await fetch('/api/v1/scheduler/stats');
                const data = await response.json();

                if (response.ok) {
                    displaySchedulerStats(data.data);
                } else {
                    console.error('Failed to load stats:', data.error);
                }
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        function displaySchedulerStats(stats) {
            const container = document.getElementById('schedulerStats');
            
            container.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${stats.total_jobs}</div>
                        <div class="stat-label">Total Jobs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.active_jobs}</div>
                        <div class="stat-label">Active Jobs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.paused_jobs}</div>
                        <div class="stat-label">Paused Jobs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.running_jobs}</div>
                        <div class="stat-label">Running Jobs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.error_jobs}</div>
                        <div class="stat-label">Error Jobs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.total_runs}</div>
                        <div class="stat-label">Total Runs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.total_errors}</div>
                        <div class="stat-label">Total Errors</div>
                    </div>
                </div>
            `;
        }

        async function exportScheduledJobs() {
            try {
                const response = await fetch('/api/v1/scheduler/export');
                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `scheduled_jobs_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.json`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                } else {
                    alert('Failed to export jobs');
                }
            } catch (error) {
                alert('Error exporting jobs: ' + error.message);
            }
        }

        async function importScheduledJobs(input) {
            const file = input.files[0];
            if (!file) return;

            const formData = new FormData();
            formData.append('file', file);

            try {
                const response = await fetch('/api/v1/scheduler/import', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    alert('Jobs imported successfully!');
                    loadScheduledJobs();
                } else {
                    alert('Failed to import jobs: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Error importing jobs: ' + error.message);
            }

            // Clear file input
            input.value = '';
        }
    </script>
</body>
</html> 